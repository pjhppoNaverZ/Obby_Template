fileFormatVersion: 2
guid: bf8ebc80ee02fa14788274f198d142c6
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst UnityEngine_1 = require(\"UnityEngine\");\r\nconst
    ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst ZEPETO_Character_Controller_1
    = require(\"ZEPETO.Character.Controller\");\r\nconst UnityEngine_SceneManagement_1
    = require(\"UnityEngine.SceneManagement\");\r\nconst UIManager_1 = require(\"./UIManager\");\r\nconst
    ZEPETO_World_1 = require(\"ZEPETO.World\");\r\n// This class set up the game
    levels and controls if the player wins or loses\r\nclass WorldState extends ZEPETO_Script_1.ZepetoScriptBehaviour
    {\r\n    // Awake is called when the script instance is being loaded\r\n    Awake()
    {\r\n        // This is how the instance of this class is allocated. Which makes
    it a \"singleton\"\r\n        // https://en.wikipedia.org/wiki/Singleton_pattern\r\n       
    if (ZEPETO_Script_1.ZepetoScriptBehaviour.op_Equality(WorldState.Instance, null))
    {\r\n            WorldState.Instance = this;\r\n        }\r\n        else {\r\n           
    UnityEngine_1.GameObject.Destroy(this);\r\n        }\r\n    }\r\n    // Start
    is called on the frame when a script is enabled just before any of the Update
    methods is called the first time\r\n    Start() {\r\n        // Call to the start
    UI \r\n        UIManager_1.default.Instance.OnStart();\r\n        this.OnStartGame();\r\n   
    }\r\n    // This method is responsible for spawning the player\r\n    SpawnPlayer()
    {\r\n        // Set the internal player spawn flag to true\r\n        this._playerSpawned
    = true;\r\n        // Instance of the player zepeto\r\n        $extension(\"ZEPETO.Character.Controller.ZepetoPlayersExtension\").CreatePlayerWithUserId(ZEPETO_Character_Controller_1.ZepetoPlayers.instance,
    ZEPETO_World_1.WorldService.userId, new ZEPETO_Character_Controller_1.SpawnInfo(),
    true);\r\n        // The instantiation can take a few seconds, the following
    lines are executed once this happens\r\n        ZEPETO_Character_Controller_1.ZepetoPlayers.instance.OnAddedLocalPlayer.AddListener(()
    => {\r\n            // We save the reference of the ZepetoCharacter\r\n           
    this.zepetoCharacter = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.LocalPlayer.zepetoPlayer.character;\r\n           
    // Find a object with the type of UIZepetoPlayerControl and set it on the variable\r\n           
    this.controlUI = UnityEngine_1.GameObject.FindObjectOfType($typeof(ZEPETO_Character_Controller_1.UIZepetoPlayerControl));\r\n       
    });\r\n    }\r\n    // This method resets the game state\r\n    ResetGameVariables()
    {\r\n        // Set to false the internal flag \"canWin\"\r\n        this.canWin
    = false;\r\n    }\r\n    // This method is responsible for resetting the level\r\n   
    ResetMap() {\r\n        // We reload the scene\r\n        // https://docs.unity3d.com/ScriptReference/SceneManagement.SceneManager.LoadScene.html\r\n       
    UnityEngine_SceneManagement_1.SceneManager.LoadScene(UnityEngine_SceneManagement_1.SceneManager.GetActiveScene().name);\r\n   
    }\r\n    // This method is called when player start the game\r\n    OnStartGame()
    {\r\n        // If this player is not generated, we call the respective method\r\n       
    if (!this._playerSpawned)\r\n            this.SpawnPlayer();\r\n        // Finally
    we set the internal flag that it is possible to win\r\n        this.canWin =
    true;\r\n        this.ControlPlayer(true);\r\n    }\r\n    // This method is
    called when the player wins\r\n    OnVictory() {\r\n        // Calling the same
    event in the UIManagers\r\n        UIManager_1.default.Instance.OnVictory();\r\n       
    // We call the internal method that resets the game variables\r\n        this.ResetGameVariables();\r\n       
    this.ControlPlayer(false);\r\n    }\r\n    // This method is called when the
    player loses\r\n    OnGameOver() {\r\n        // We call the internal method
    that resets the game variables\r\n        this.ResetGameVariables();\r\n       
    this.ControlPlayer(false);\r\n    }\r\n    // This function active or deactive
    the control of the player\r\n    ControlPlayer(activePlayer) {\r\n        //
    If the controlUI is not null, deactivate the object\r\n        this.controlUI?.gameObject.SetActive(activePlayer);\r\n       
    // Check if the player have to be active and set the camera sensitivity on 5
    or 0 \r\n        if (activePlayer)\r\n            ZEPETO_Character_Controller_1.ZepetoPlayers.instance.cameraData.sensitivity
    = 5;\r\n        else\r\n            ZEPETO_Character_Controller_1.ZepetoPlayers.instance.cameraData.sensitivity
    = 0;\r\n    }\r\n}\r\nexports.default = WorldState;\r\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiV29ybGRTdGF0ZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIldvcmxkU3RhdGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSw2Q0FBK0M7QUFDL0MsaURBQXFEO0FBQ3JELDZFQUE4RztBQUM5Ryw2RUFBMkQ7QUFDM0QsMkNBQW9DO0FBQ3BDLCtDQUE0QztBQUU1Qyw2RUFBNkU7QUFDN0UsTUFBcUIsVUFBVyxTQUFRLHFDQUFxQjtJQVV6RCwyREFBMkQ7SUFDM0QsS0FBSztRQUNELG9GQUFvRjtRQUNwRixrREFBa0Q7UUFDbEQsSUFyQkMscUNBQXFCLENBNEcyckYsV0FBWSxDQXZGenRGLFVBQVUsQ0FBQyxRQUFRLEVBQUksSUFBSSxHQUFFO1lBQzdCLFVBQVUsQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDO1NBQzlCO2FBQU07WUFDSCx3QkFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUM1QjtJQUNMLENBQUM7SUFFRCx1SEFBdUg7SUFDdkgsS0FBSztRQUNELHdCQUF3QjtRQUN4QixtQkFBUyxDQUFDLFFBQVEsQ0FBQyxPQUFPLEVBQUUsQ0FBQztRQUU3QixJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7SUFDdkIsQ0FBQztJQUVELHFEQUFxRDtJQUNyRCxXQUFXO1FBQ1AsNkNBQTZDO1FBQzdDLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDO1FBRTNCLGdDQUFnQztRQUNoQyxpRUFBdUIsc0JBQXNCLENBQTdDLDJDQUFhLENBQUMsUUFBUSxFQUF3QiwyQkFBWSxDQUFDLE1BQU0sRUFBRSxJQUFJLHVDQUFTLEVBQUUsRUFBRSxJQUFJLEVBQUU7UUFFMUYsK0ZBQStGO1FBQy9GLDJDQUFhLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLFdBQVcsQ0FBQyxHQUFHLEVBQUU7WUFDdkQsK0NBQStDO1lBQy9DLElBQUksQ0FBQyxlQUFlLEdBQUcsMkNBQWEsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUM7WUFFakYsa0ZBQWtGO1lBQ2xGLElBQUksQ0FBQyxTQUFTLEdBQUcsd0JBQVUsQ0FBQyxnQkFBZ0IsU0FBQyxtREFBcUIsRUFBRyxDQUFDO1FBQzFFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQztJQUVELG9DQUFvQztJQUNwQyxrQkFBa0I7UUFDZCwwQ0FBMEM7UUFDMUMsSUFBSSxDQUFDLE1BQU0sR0FBRyxLQUFLLENBQUM7SUFFeEIsQ0FBQztJQUVELHFEQUFxRDtJQUNyRCxRQUFRO1FBQ0osc0JBQXNCO1FBQ3RCLHVGQUF1RjtRQUN2RiwwQ0FBWSxDQUFDLFNBQVMsQ0FBQywwQ0FBWSxDQUFDLGNBQWMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFFRCxtREFBbUQ7SUFDbkQsV0FBVztRQUNQLGlFQUFpRTtRQUNqRSxJQUFJLENBQUMsSUFBSSxDQUFDLGNBQWM7WUFBRSxJQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7UUFFN0MsOERBQThEO1FBQzlELElBQUksQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDO1FBRW5CLElBQUksQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDN0IsQ0FBQztJQUVELDZDQUE2QztJQUM3QyxTQUFTO1FBQ0wsMkNBQTJDO1FBQzNDLG1CQUFTLENBQUMsUUFBUSxDQUFDLFNBQVMsRUFBRSxDQUFDO1FBRS9CLDZEQUE2RDtRQUM3RCxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUUxQixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCw4Q0FBOEM7SUFDOUMsVUFBVTtRQUVOLDZEQUE2RDtRQUM3RCxJQUFJLENBQUMsa0JBQWtCLEVBQUUsQ0FBQztRQUUxQixJQUFJLENBQUMsYUFBYSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRCw2REFBNkQ7SUFDdEQsYUFBYSxDQUFDLFlBQWtCO1FBQ25DLHNEQUFzRDtRQUN0RCxJQUFJLENBQUMsU0FBUyxFQUFFLFVBQVUsQ0FBQyxTQUFTLENBQUMsWUFBWSxDQUFDLENBQUM7UUFFbkQsa0ZBQWtGO1FBQ2xGLElBQUksWUFBWTtZQUFFLDJDQUFhLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxXQUFXLEdBQUcsQ0FBQyxDQUFDOztZQUMvRCwyQ0FBYSxDQUFDLFFBQVEsQ0FBQyxVQUFVLENBQUMsV0FBVyxHQUFHLENBQUMsQ0FBQztJQUMzRCxDQUFDO0NBQ0o7QUFyR0QsNkJBcUdDIn0=","assetPath":"Assets/StaticResources/Scripts/Managers/WorldState.ts","manifest":{"properties":[{"assembly":"mscorlib","name":"canWin","type":"System.Boolean","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"HideInInspector","args":[]}]},{"assembly":"ZEPETO.Character.Controller","name":"zepetoCharacter","type":"ZEPETO.Character.Controller.ZepetoCharacter","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[{"name":"HideInInspector","args":[]}]}],"name":"WorldState","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: d34825af71297d4806f7c7a80702df30
  onlyWriteTrigger: 0
